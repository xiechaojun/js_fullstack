<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>Document</title>
</head>
<body>
  <!-- js中的浅拷贝和深拷贝 -->
  <!-- <script>
    // 解构
    function example() {
      return [1,2,3]
    }
    // let b = example()[1]
    // console.log(b)
    let [a,b,c] = example()
    console.log(a)
    // 对象的解构
    // let {foo,bar} = {foo:"aaa",bar:"bbb"}
    let {foo:baz} = {foo:"abc"}  //重命名了
    console.log(foo)  //打印不出abc
    console.log(baz)  
  </script> -->
  <!-- <script>
    //浅拷贝   非基础数据类型才会被影响
    let obj = {
      name:"wanwan",
      age:18,
      like:['sing','reading']
    }
    // let obj2 = Object.assign({},obj)  //把obj放到obj2里  赋值
    // let obj3 = Object.assign(obj2,like)  //在obj里加like
    obj.name = 'eifi'
    obj.like.push('coding')
    let obj2 = Object.assign({},obj)
    let obj3 = {...obj}                  //解构
    console.log(obj2)
    console.log(obj3)
    // console.log({...obj})
    // 深拷贝
    // let obj4 = JSON.stringify(obj)   //把obj对象转成字符串
    // let obj4 = JSON.parse(JSON.stringify(obj))  //把字符串转回对象
    let obj4 = JSON.parse(JSON.stringify(obj))
    obj.name = 'wanwanwan'
    console.log(obj4)
  </script> -->
  <script>
    // 深拷贝的原理
    function deepClone(obj,hash = new WeakMap()) {  //递归，层层获取
      if (obj instanceof RegExp) {  //正则
        return RegExp(obj)
      }
      if (obj instanceof Data) {   //日期
        return Date(obj)
      }
      if (obj === null || typeof obj !== 'object') {  
        // 如果不是复杂数据类型 直接返回
        return obj 
      }
      if (hash.has(obj)) {
        return hash.get(obj)
      }
      // 如果obj是数组，那么obj.constructor 是 [function:Array]
      // 如果obj是对象，那么obj.constructor 是 [function:object]
      let t = new obj.constructor()
      hash.set(obj,t)  //把t往obj数组set加入值
      for (let key in obj) {
        // 递归
        if (obj.hasOwnProperty(key)) {  //判断是否是自身的属性
          t[key] = deepClone(obj[key],hash)
        }
      }
      return t
    }
  </script>
</body>
</html>